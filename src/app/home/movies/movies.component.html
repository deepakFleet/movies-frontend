<div class="bg-primary-reverse pt-0 movies-container">
  <div
    class="movie-controller-bar bg-primary-reverse shadow-1 flex justify-content-around flex-row w-full">
    <div class="flex flex-row flex-1 pl-3">
      <p-dropdown
        [options]="sortByOptions"
        [(ngModel)]="sortedBy"
        placeholder="Sort By"
        optionLabel="name"
        [showClear]="true"></p-dropdown>
      <p-dropdown
        class="ml-2"
        [options]="sortOrderOptions"
        [(ngModel)]="sortedOrder"
        placeholder="Sort Order"
        optionLabel="name"
        [showClear]="true"></p-dropdown>
      <p-dropdown
        styleClass="genre-dropdown"
        class="ml-2"
        [options]="groupedGenres$ | async"
        [(ngModel)]="genreSelected"
        placeholder="Filter by genre"
        optionLabel="name"
        [group]="(favouriteGenres$ | async).length"
        [showClear]="false">
        <ng-template pTemplate="selectedItem">
          <div class="country-item country-item-value" *ngIf="genreSelected">
            <div>{{ genreSelected.name }}</div>
          </div>
        </ng-template>
        <ng-template let-genre pTemplate="item">
          <div class="country-item">
            <div
              class="flex justify-content-between flex-row align-items-center">
              <div>{{ genre.name }}</div>
              <button
                pButton
                (click)="onFavouriteClick($event, genre)"
                type="button"
                [icon]="
                  favouriteGenres$.getValue().indexOf(genre) === -1
                    ? 'pi pi-star'
                    : 'pi pi-star-fill'
                "
                class="p-button-rounded p-button-text"
                [ngClass]="{
                  'p-button-secondary': genreSelected === genre
                }"></button>
            </div>
          </div>
        </ng-template>
      </p-dropdown>
    </div>
    <div>
      <p-dropdown
        class="mr-2"
        [options]="viewOptions"
        [(ngModel)]="viewMode"
        placeholder="Sort Order"
        optionLabel="name"
        [showClear]="false"></p-dropdown>
      <app-search></app-search>
    </div>
  </div>
  <div class="pt-2 grid grid-nogutter">
    <p-card
      *ngFor="let movie of movies$ | async"
      class="col-3 p-3 movie-card"
      [header]="movie.name"
      [subheader]="movie.releaseDate.toString()">
      <ng-template pTemplate="header">
        <div
          class="movie-header"
          [style.background-color]="movieService.randomColor$ | async"></div>
      </ng-template>

      <span class="card-content text-gray-300">
        {{ movie.genres.length > 0 ? movie.genres : 'N/A' }}
      </span>

      <ng-template pTemplate="footer">
        <button
          pButton
          pRipple
          type="button"
          icon="pi pi-arrow-up"
          class="p-button-rounded p-button-outlined"></button>
      </ng-template>
    </p-card>
  </div>
</div>
